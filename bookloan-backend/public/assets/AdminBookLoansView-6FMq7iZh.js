import{_ as R}from"./AdminNavComponent-vqZHHoGb.js";import{_ as x}from"./CardComponent-y3fshIoW.js";import{r as u,o as T,a as r,c,e as h,b as a,F as k,d as y,m as B,t as i,i as v,n as f}from"./index-kPpeyqsD.js";import{u as $}from"./book-33oAz_Dg.js";import"./ButtonComponent-_B2EXK9V.js";const C={class:"flex gap-4"},S={class:"p-4"},j={key:0},L=a("h2",{class:"font-semibold text-base"},"Unapproved/Pending Book Loans",-1),V={class:"grid grid-cols-1 md:grid-cols-3 gap-1 bg-primary-green mx-auto w-full container py-2"},q={class:"flex gap-2 mx-2"},D={class:"flex flex-col gap-2"},N=["onClick"],z=["onClick"],F={class:"bg-white py-2 px-6 text-xs"},E=a("span",{class:"font-semibold"},"Loan Requested By:",-1),M=a("span",{class:"font-semibold"},"Request Date:",-1),P=a("span",{class:"font-semibold"},"Due Date:",-1),U=a("span",{class:"font-semibold"},"Status:",-1),G={key:1,class:"mt-4"},H=a("h2",{class:"font-semibold text-base"},"Approved Book Loans",-1),J={class:"grid grid-cols-1 md:grid-cols-3 gap-1 bg-yellow-300 mx-auto w-full container py-2"},K={class:"flex gap-2 mx-8"},O=["onClick"],ee={__name:"AdminBookLoansView",setup(Q){const m=$(),n=u([]),l=u([]),d=u([]),p=u("Approve Loan"),_=u("Reject Request"),g=u("Terminate Loan");T(async()=>{if(await m.getAllBooks(),n.value=await m.getBooks,n.value)for(let o=0;o<n.value.length;o++)if(console.log(o,n.value[o].loan),n.value[o].loan)n.value[o].loan.status==="pending"&&(l.value.push(n.value[o]),console.log(l.value)),n.value[o].loan.status==="approved"&&d.value.push(n.value[o]);else continue});const b=async o=>{try{p.value="Approving...";const t=localStorage.getItem("token"),e=await f.post("/bookloans/"+o+"/approve",{},{headers:{Authorization:`Bearer ${t}`}});e.data.success&&(p.value="Approved",d.value.push(l.value.find(s=>s.loan.id===o)),l.value=l.value.filter(s=>s.loan.id!==o),alert(e.data.message))}catch(t){console.log(t)}finally{p.value="Approve Loan"}},w=async o=>{try{_.value="Rejecting...";const t=localStorage.getItem("token"),e=await f.post("/bookloans/"+o+"/reject",{},{headers:{Authorization:`Bearer ${t}`}});e.data.success&&(alert(e.data.message),l.value=l.value.filter(s=>s.loan.id!==o))}catch(t){console.log(t)}finally{_.value="Reject Request"}},A=async o=>{try{g.value="Terminating...";const t=localStorage.getItem("token"),e=await f.post("/bookloans/"+o+"/terminate",{},{headers:{Authorization:`Bearer ${t}`}});e.data.success&&(alert(e.data.message),d.value=d.value.filter(s=>s.loan.id!==o))}catch(t){console.log(t)}finally{g.value="Terminate Loan"}};return(o,t)=>(r(),c("main",C,[h(R),a("div",S,[l.value.length>0?(r(),c("div",j,[L,a("div",V,[(r(!0),c(k,null,y(l.value,e=>(r(),c("div",{key:e.id},[h(x,{info:e},null,8,["info"]),a("div",q,[a("div",D,[a("span",{onClick:s=>b(e.loan.id),class:"bg-primary-orange text-white py-2 px-6 text-xs w-fit h-fit cursor-pointer"},i(p.value),9,N),a("span",{onClick:s=>w(e.loan.id),class:"bg-primary-orange text-white py-2 px-6 text-xs w-fit h-fit cursor-pointer"},i(_.value),9,z)]),a("div",F,[a("p",null,[E,v(" "+i(e.loan.loaned_to.name)+", "+i(e.loan.loaned_to.email),1)]),a("p",null,[M,v(" "+i(e.loan.loan_date),1)]),a("p",null,[P,v(" "+i(e.loan.due_date),1)]),a("p",null,[U,v(" "+i(e.loan.status),1)])])])]))),128))])])):B("",!0),d.value.length>0?(r(),c("div",G,[H,a("div",J,[(r(!0),c(k,null,y(d.value,e=>(r(),c("div",{key:e.id},[h(x,{info:e},null,8,["info"]),a("div",K,[a("span",{onClick:s=>A(e.loan.id),class:"bg-primary-orange text-white py-2 px-6 text-xs cursor-pointer"},i(g.value),9,O)])]))),128))])])):B("",!0)])]))}};export{ee as default};
