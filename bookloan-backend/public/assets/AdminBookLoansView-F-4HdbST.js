import{_ as $}from"./AdminNavComponent-FrgZ9gL2.js";import{_ as k}from"./CardComponent-9AHvbEoX.js";import{k as R,r as u,o as C,a as r,c,b as f,e as s,F as y,d as B,p as b,t as i,i as _,m}from"./index-zlIGHKXK.js";import{u as S}from"./book-t9Z8p0pt.js";import"./ButtonComponent-Rb31Mvhp.js";const j={class:"flex gap-4"},L={class:"p-4"},V={key:0},q=s("h2",{class:"font-semibold text-base"},"Unapproved/Pending Book Loans",-1),D={class:"grid grid-cols-1 md:grid-cols-3 gap-1 bg-primary-green mx-auto w-full container py-2"},N={class:"flex gap-2 mx-2"},z={class:"flex flex-col gap-2"},E=["onClick"],F=["onClick"],M={class:"bg-white py-2 px-6 text-xs"},P=s("span",{class:"font-semibold"},"Loan Requested By:",-1),U=s("span",{class:"font-semibold"},"Request Date:",-1),G=s("span",{class:"font-semibold"},"Due Date:",-1),H=s("span",{class:"font-semibold"},"Status:",-1),J={key:1,class:"mt-4"},K=s("h2",{class:"font-semibold text-base"},"Approved Book Loans",-1),O={class:"grid grid-cols-1 md:grid-cols-3 gap-1 bg-yellow-300 mx-auto w-full container py-2"},Q={class:"flex gap-2 mx-8"},W=["onClick"],se={__name:"AdminBookLoansView",setup(X){const x=S(),p=R.useToast(),n=u([]),l=u([]),d=u([]),v=u("Approve Loan"),g=u("Reject Request"),h=u("Terminate Loan");C(async()=>{if(await x.getAllBooks(),n.value=await x.getBooks,n.value)for(let o=0;o<n.value.length;o++)if(console.log(o,n.value[o].loan),n.value[o].loan)n.value[o].loan.status==="pending"&&(l.value.push(n.value[o]),console.log(l.value)),n.value[o].loan.status==="approved"&&d.value.push(n.value[o]);else continue});const w=async o=>{try{v.value="Approving...";const a=localStorage.getItem("token"),e=await m.post("/bookloans/"+o+"/approve",{},{headers:{Authorization:`Bearer ${a}`}});e.data.success&&(v.value="Approved",d.value.push(l.value.find(t=>t.loan.id===o)),l.value=l.value.filter(t=>t.loan.id!==o),p.success(e.data.message))}catch(a){console.log(a),p.error(a.response.data.message)}finally{v.value="Approve Loan"}},A=async o=>{try{g.value="Rejecting...";const a=localStorage.getItem("token"),e=await m.post("/bookloans/"+o+"/reject",{},{headers:{Authorization:`Bearer ${a}`}});e.data.success&&(p.success(e.data.message),l.value=l.value.filter(t=>t.loan.id!==o))}catch(a){console.log(a)}finally{g.value="Reject Request"}},T=async o=>{try{h.value="Terminating...";const a=localStorage.getItem("token"),e=await m.post("/bookloans/"+o+"/terminate",{},{headers:{Authorization:`Bearer ${a}`}});e.data.success&&(p.success(e.data.message),d.value=d.value.filter(t=>t.loan.id!==o))}catch(a){console.log(a)}finally{h.value="Terminate Loan"}};return(o,a)=>(r(),c("main",j,[f($),s("div",L,[l.value.length>0?(r(),c("div",V,[q,s("div",D,[(r(!0),c(y,null,B(l.value,e=>(r(),c("div",{key:e.id},[f(k,{info:e},null,8,["info"]),s("div",N,[s("div",z,[s("span",{onClick:t=>w(e.loan.id),class:"bg-primary-orange text-white py-2 px-6 text-xs w-fit h-fit cursor-pointer"},i(v.value),9,E),s("span",{onClick:t=>A(e.loan.id),class:"bg-primary-orange text-white py-2 px-6 text-xs w-fit h-fit cursor-pointer"},i(g.value),9,F)]),s("div",M,[s("p",null,[P,_(" "+i(e.loan.loaned_to.name)+", "+i(e.loan.loaned_to.email),1)]),s("p",null,[U,_(" "+i(e.loan.loan_date),1)]),s("p",null,[G,_(" "+i(e.loan.due_date),1)]),s("p",null,[H,_(" "+i(e.loan.status),1)])])])]))),128))])])):b("",!0),d.value.length>0?(r(),c("div",J,[K,s("div",O,[(r(!0),c(y,null,B(d.value,e=>(r(),c("div",{key:e.id},[f(k,{info:e},null,8,["info"]),s("div",Q,[s("span",{onClick:t=>T(e.loan.id),class:"bg-primary-orange text-white py-2 px-6 text-xs cursor-pointer"},i(h.value),9,W)])]))),128))])])):b("",!0)])]))}};export{se as default};
