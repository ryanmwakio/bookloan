import{_ as p}from"./AdminNavComponent-vqZHHoGb.js";import{q as f,n as d,r as g,o as b,a as n,c as i,e as u,b as e,w as x,f as U,F as k,d as y,i as v,R as A,t as c}from"./index-kPpeyqsD.js";const w=f("user",{state:()=>({users:[]}),getters:{getUsers:s=>s.users},actions:{async fetchUsers(){const s=localStorage.getItem("token");if(!s)return;const{data:t}=await d.get("/users",{headers:{Authorization:`Bearer ${s}`}});this.users=t.data},async makeUserAdmin(s){const t=localStorage.getItem("token");t&&(await d.post(`/users/${s}/makeadmin`,{},{headers:{Authorization:`Bearer ${t}`}}),this.fetchUsers(),alert("user added as admin"))},async removeUserAdmin(s){const t=localStorage.getItem("token");t&&(await d.post(`/users/${s}/removeadmin`,{},{headers:{Authorization:`Bearer ${t}`}}),this.fetchUsers(),alert("user removed as admin"))},async deleteUser(s){const t=localStorage.getItem("token");t&&(await d.delete(`/users/${s}`,{headers:{Authorization:`Bearer ${t}`}}),this.fetchUsers(),alert("user deleted"))}}}),$={class:"flex gap-4"},S={class:"p-4 my-4"},B={class:"w-full text-xs mt-4 border"},C=e("thead",{class:"border"},[e("tr",{class:"text-left"},[e("th",{class:"p-2 border"},"Name"),e("th",{class:"p-2 border"},"Email"),e("th",{class:"p-2 border"},"Role"),e("th",{class:"p-2 border"},"Actions")])],-1),z={class:"p-2 border"},I={class:"p-2 border"},N={class:"p-2 border"},V={class:"flex gap-2 items-center"},R=["onChange"],D=e("option",{value:"user"},"change role",-1),E=e("option",{value:"admin"},"Admin",-1),F=[D,E],L=["onChange"],q=e("option",{value:"admin"},"change role",-1),M=e("option",{value:"user"},"User",-1),T=[q,M],j={class:"p-2 flex gap-2 border"},G=["onClick"],O={__name:"AdminUsersView",setup(s){const t=w(),a=g([]),h=o=>{t.makeUserAdmin(o),a.value=t.getUsers},m=o=>{t.removeUserAdmin(o),a.value=t.getUsers},_=o=>{confirm("Are you sure you want to delete this user?")&&(t.deleteUser(o),a.value=t.getUsers)};return b(async()=>{await t.fetchUsers(),a.value=t.getUsers}),(o,H)=>(n(),i("main",$,[u(p),e("div",S,[e("div",null,[u(U(A),{to:"/register",class:"bg-primary-orange text-white py-2 px-6 text-xs w-fit h-fit"},{default:x(()=>[v("Add User")]),_:1})]),e("table",B,[C,e("tbody",null,[(n(!0),i(k,null,y(a.value,r=>(n(),i("tr",{class:"border-b py-2",key:r.id},[e("td",z,c(r.name),1),e("td",I,c(r.email),1),e("td",N,[e("p",null,c(r.role),1),e("div",V,[r.role!=="admin"?(n(),i("select",{key:0,name:"",id:"",class:"border border-primary-black focus:outline-none text-xs cursor-pointer my-2",onChange:l=>h(r.id)},F,40,R)):(n(),i("select",{key:1,name:"",id:"",class:"border border-primary-black focus:outline-none text-xs cursor-pointer my-2",onChange:l=>m(r.id)},T,40,L))])]),e("td",j,[e("button",{class:"bg-red-500 text-white py-2 px-6 text-xs w-fit h-fit",onClick:l=>_(r.id)}," Delete ",8,G)])]))),128))])])])]))}};export{O as default};
