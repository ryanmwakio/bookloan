import{_ as f}from"./AdminNavComponent-FrgZ9gL2.js";import{s as g,m as d,k as b,r as x,o as U,a as i,c,b as m,e,w as k,f as y,F as v,d as A,i as w,R as $,t as l}from"./index-zlIGHKXK.js";const S=g("user",{state:()=>({users:[]}),getters:{getUsers:s=>s.users},actions:{async fetchUsers(){const s=localStorage.getItem("token");if(!s)return;const{data:t}=await d.get("/users",{headers:{Authorization:`Bearer ${s}`}});this.users=t.data},async makeUserAdmin(s){const t=localStorage.getItem("token");t&&(await d.post(`/users/${s}/makeadmin`,{},{headers:{Authorization:`Bearer ${t}`}}),this.fetchUsers(),alert("user added as admin"))},async removeUserAdmin(s){const t=localStorage.getItem("token");t&&(await d.post(`/users/${s}/removeadmin`,{},{headers:{Authorization:`Bearer ${t}`}}),this.fetchUsers(),alert("user removed as admin"))},async deleteUser(s){const t=localStorage.getItem("token");t&&(await d.delete(`/users/${s}`,{headers:{Authorization:`Bearer ${t}`}}),this.fetchUsers())}}}),B={class:"flex gap-4"},C={class:"p-4 my-4"},z={class:"w-full text-xs mt-4 border"},I=e("thead",{class:"border"},[e("tr",{class:"text-left"},[e("th",{class:"p-2 border"},"Name"),e("th",{class:"p-2 border"},"Email"),e("th",{class:"p-2 border"},"Role"),e("th",{class:"p-2 border"},"Actions")])],-1),N={class:"p-2 border"},V={class:"p-2 border"},E={class:"p-2 border"},R={class:"flex gap-2 items-center"},D=["onChange"],F=e("option",{value:"user"},"change role",-1),L=e("option",{value:"admin"},"Admin",-1),T=[F,L],M=["onChange"],j=e("option",{value:"admin"},"change role",-1),q=e("option",{value:"user"},"User",-1),G=[j,q],H={class:"p-2 flex gap-2 border"},J=["onClick"],Q={__name:"AdminUsersView",setup(s){const t=b.useToast(),r=S(),n=x([]),h=a=>{r.makeUserAdmin(a),n.value=r.getUsers},_=a=>{r.removeUserAdmin(a),n.value=r.getUsers},p=a=>{confirm("Are you sure you want to delete this user?")&&(r.deleteUser(a),n.value=r.getUsers,t.success("User deleted successfully"))};return U(async()=>{await r.fetchUsers(),n.value=r.getUsers}),(a,K)=>(i(),c("main",B,[m(f),e("div",C,[e("div",null,[m(y($),{to:"/register",class:"bg-primary-orange text-white py-2 px-6 text-xs w-fit h-fit"},{default:k(()=>[w("Add User")]),_:1})]),e("table",z,[I,e("tbody",null,[(i(!0),c(v,null,A(n.value,o=>(i(),c("tr",{class:"border-b py-2",key:o.id},[e("td",N,l(o.name),1),e("td",V,l(o.email),1),e("td",E,[e("p",null,l(o.role),1),e("div",R,[o.role!=="admin"?(i(),c("select",{key:0,name:"",id:"",class:"border border-primary-black focus:outline-none text-xs cursor-pointer my-2",onChange:u=>h(o.id)},T,40,D)):(i(),c("select",{key:1,name:"",id:"",class:"border border-primary-black focus:outline-none text-xs cursor-pointer my-2",onChange:u=>_(o.id)},G,40,M))])]),e("td",H,[e("button",{class:"bg-red-500 text-white py-2 px-6 text-xs w-fit h-fit",onClick:u=>p(o.id)}," Delete ",8,J)])]))),128))])])])]))}};export{Q as default};
